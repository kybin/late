<!DOCTYPE html5>
<html>

<head>
<meta charset="UTF-8">

<script type="text/javascript" src="script/jquery.js"></script>

<script type="text/javascript">
$(document).ready(function() {
	$(".sticky-new").on({
		click:function() {
			$.ajax({
				url: "/update",
				data: {
					test:"are you alright?"
				},
				success: function( data ) {
					console.log("success");
				}
			});
		}
	});

	$("textarea").each(function() {
		var offset = this.offsetHeight - this.clientHeight;
		$(this).css('height', this.scrollHeight + offset);
	});

	$("textarea").bind("input propertychange", function() {
		$(this).parent().parent().find(".sticky-bar").css("display", "block");
		var offset = this.offsetHeight - this.clientHeight;
		// TODO: $(this).css('height', 'auto') couldn't shirink textarea nicely,
		// what's the alternatives? no plug-in.
		$(this).css('height', this.scrollHeight + offset);
	});

	$(".button").on({
		click:function() {
			$(this).parent(".sticky-bar").css("display", "none");
			$(this).parent().parent().find("textarea").each(function() {
				var offset = this.offsetHeight - this.clientHeight;
				$(this).css('height', 'auto').css('height', this.scrollHeight + offset);
			});
		}
	});
});
</script>

<style>
#title {
	text-align:center;
	font-size:30px;
	height:70px;
	line-height:70px;
}

#tab-selector {
	height:25px;
	border-style:none none solid none;
	border-width:1px;
}

#tab {
	float:left;
	width:80px;
	margin:0px 10px 0px 0px;
	background-color:yellow;
	border-style:solid;
	border-width:1px;
}

#main {
	display:table;
	margin:0 auto;
}

.blank {
	width:600px;
	height:50px;
}

.sticky {
	border-style:solid;
	border-width:3px;
	border-radius:8px;
}

.sticky-new {
	cursor:pointer;
	border-style:solid;
	border-width:3px;
	border-radius:8px;
	color:#C0C0C0;
}

.sticky-new:hover {
	color:#848484;
}

.sticky-top {
	border-style:inherit;
	border-width:0px 0px 1px 0px;
	padding:5px;
}

.sticky-bottom {
	padding:5px;
}

.sticky-bar {
	height:40px;
	border-style:inherit;
	border-width:1px 0px 0px 0px;
	background-color:#F0F0F0;
	display:none;
	padding:3px 10px;
}

.button {
	width:80px;
	height:30px;
	border-style:solid;
	border-width:1px;
	border-color:#999999;
	border-radius:6px;
	text-align:center;
	color:white;
}

.v-middle {
	position:relative;
	top:50%;
	transform:translateY(-50%);
}

.left {
	float:left;
}

.right {
	float:right;
}

.blue {
	background-color:#668cff;
}

.red {
	background-color:#ff704d;
}

textarea {
	padding:5px;
	border:none;
	width:600px;
	min-height:80px;
	height:auto;
	overflow-y:hidden;
	resize:none;
	cursor:inherit;
}

</style>
</head>

<body>
	<div id="title">{{.Title}}</div>
	<div id="tab-selector">
		{{range .Chapters}}<div id="tab">Capter{{.Num}}</div>{{end}}
	</div>
	<div id="main">
		{{with index .Chapters 0}}
			{{range .Snippets}}
				<div class="blank">
				</div>
				<div class="sticky">
					<div class="sticky-top">
						<textarea>{{.Orig}}</textarea>
					</div>
					<div class="sticky-bottom">
						<textarea>{{.Trans}}</textarea>
					</div>
					<div class="sticky-bar">
						<button class="button v-middle left red">Cancel</button>
						<button class="button v-middle right blue">Save</button>
					</div>
				</div>
			{{end}}
		{{end}}
		<div class="blank">
		</div>
		<div class="sticky-new">
			<div class="sticky-top">
				<textarea></textarea>
			</div>
			<div class="sticky-bottom">
				<textarea></textarea>
			</div>
		</div>
	</div>
</body>

</html>
